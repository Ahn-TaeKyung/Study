# 에이지 오브 엠파이어

트라이브스와 비슷한 시기에 RTS 게임인 에이지 오브 엠파이어가 출시 되었다.
동시기에 출시되다 보니 에이지 오브 엠파이어 또한, 비슷한 대역폭 문제와 인터넷 전화 접속의 레이턴시 문제를 안고 있었다.
에이지 오브 엠파이어는 결정론적 락스텝 모델을 채택했는데, 이 모델에선 컴퓨터 하나하나가  P2P 방식으로 다른 모든 컴퓨터에 연결하는 방식을 채용했다.
결정론이 보장된느 게임에선 모든 피어가 각각 동시에 병행하여 시뮬레이션을 진행한다. 그리고 게임이 진행되는 내내 모든 피어의 동기화를 맞추기 위해 통신에 락스텝을 사용한다.
트라이브스의 사례와 유사하게, 결정론적 락스텝 모델도 오랫동안 여러 게임에서 사용됐고, 최신 RTS 게임에서도 여전히 쓰이는 기술이다. 이후 만들어 볼 볼 로보캣 RTS 게임도 결정론적 락스텝 모델로 구현해 보겠다.

RTS 멀티플레이어 게임을 네트워킹으로 구현하는데 있어 FPS와 비교해 가장 큰 차이점은 플레이어의 가시권에 포함되는 유닛의 개수가 많다는 점이다. 
트라이브스의 경우 128명을 꽉 채워 플레이한다 해도 어느 시점에 특정 클라이언트 하나에 보여지는 플레이어의 수는 비교적 적은 수에 불과하기 마련이다.
트라이브스에서 고스트 매니저가 한 번에 처리할 고스트의 숫자는 20에서 30건 정도가 고작이다.

이를 에이지 오브 엠파이어 같은 RTS 게임과 비교해 보자. 한번에 접속하는 플레이어 수는 훨씬 적지만, 각 플레이어는 저마다 많은 수의 유닛을 운용한다. 
방을 만들고 게임을 막 시작하는 시점엔 플레이어마다 50마리씩 만들 수 있고, 게임 후반으로 가면 최대 200마리까지 만들 수 있다.
50마리라 해도 8명이 참가하는 큰 판에선, 최대 400 유닛이 게임 내에서 돌아다니는 셈이다. 
가시권 판정을 절묘하게 하는 알고리즘이 있어서 동기화 할 유닛의 숫자를 효율적으로 다룰 수 있다 치더라도, 최악의 경우를 따져볼 필요가 있다.
만일 게임 후반 플레이어 8명이 모두 그간 쌓아둔 유닛을 총동원해 한 장소에서 격돌하면 어떻게 될까
그러면 한 번에 천 단위 숫자의 유닛이 동시에 가시권에 들어오게 될 것이다. 유닛당 정보를 아무리 최소화하더라도 이렇게 많은 유닛의 정보를 동기화하기는 매우 어려운 일이다.

이 같은 문제를 해결하기 위해 에이지 오브 엠파이어 개발자들은 개별 유닛을 하나하나 동기화하는 대신 플레이어가 입력한 명령을 동기화 하기로 했다.
얼핏 작은 차이처럼 보이지만 이는 매우 중요한 설계상 결정이다. RTS 프로게이머라 하더라도 분당 300회 이상의 명령을 내리기는 어렵다.
다시 말해 아무리 극단적인 경우라도 게임 시스템이 플레이어마다 초당 몇 회 정도의 명령만 전송할 수 있으면 충분하다. 이 정도면 수백 유닛의 정보를 보내는 것보단 대역폭 관리가 훨씬 수월한 분량이 된다.
그렇지만 유닛 정보를 네트워크를 통해 보내지 않으므로 모든 플레이어의 게임 인스턴스는 명령을 받으면 그 명령대로, 스스로 게임 시뮬레이션을 진행해야 한다.
게임 인스턴스마다 시뮬레이션을 독자적으로 수행하게 되므로 각 인스턴스를 다른 인스턴스와 정확히 동기화 할 수 있는지가 극도로 중요해진다.
결정론적 락스텝 모델을 구현하는데 있어 가장 어려운 과제가 바로 이것이다.

# 턴 타이머

각 게임 인스턴스마다 독립적으로 시뮬레이션을 수행하므로 P2P형태 의 토폴로지가 잘 어울린다. 
6장에서 논의하겠지만, P2P 모델에선 컴퓨터 사이에 데이터가 비교적 빠르게 오갈 수 있다는 장점이 있다. 서버가 중간에서 데이터를 중개할 필요가 없기 때문이다.
하지만 각 플레이어가 각자의 정보를 서버 하나에 보내는 데 그치지 않고 다른 모든 플레이어에게 전송해야 한다는 단점이 있다.
예를 들어, 플레이어 A가 공격 명령을 내릴 때 다른 모든 인스턴스가 이 공격을 인지할 수 있게끔 플레이어 A의 피어는 다른 모든 피어에 정보를 보내야 하고, 모두 정확히 같은 시점에 이 명령을 처리해야 한다.
그렇지 않으면 각 인스턴스의 시뮬레이션이 그 시점부터 발이 안 맞기 시작한다.

