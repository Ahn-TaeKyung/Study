[CH01](#CH01)

# CH01 **무선** 
첫 번째 섹션에서는 무선랜의 일반적인 문제를 소개하고 유선 네트워크와 무선 네트워크를 비교합니다. 이 섹션에서는 무선 네트워크의 특성과 이러한 유형의 네트워크에서 액세스가 제어되는 방법을 설명합니다.

두 번째 섹션에서는 IEEE 802.11 Project에 의해 정의된 무선 LAN에 대해 설명합니다. 이 섹션에서는 이러한 유형의 LAN의 아키텍처를 정의하고 MAC 부계층에 대해 설명합니다.

세 번째 섹션에서는 개인 영역 네트워크로서의 블루투스 기술에 대해 설명합니다. 이 섹션에서는 네트워크의 아키텍처, 주소 지정 메커니즘 및 패킷 형식에 대해 설명합니다. 이 프로토콜에 사용된 다양한 계층도 간략하게 설명되고 다른 유선 및 무선 LAN의 계층과 비교됩니다.
___
들어가기에 앞서

무선 통신은 가장 빠르게 성장하는 기술 중 하나입니다. 케이블을 사용하지 않고 기기를 연결하는 수요는 모든 곳에서 증가하고 있습니다. 무선랜은 대학 캠퍼스, 사무실 건물, 많은 공공장소에서 찾아볼 수 있습니다. 무선랜과 관련된 구체적인 프로토콜에 대해 논의하기 전에 일반적으로 이야기해 보겠습니다.

유선 방식과 무선 방식을 표현한 그림 이다.

<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/2a39b3fd-bd17-4861-99d5-91a6db7f252e" width="500"> 

유 / 무선 방식 만으로 만들 수 있는 각각의 네트워크 연결 방식은 다음과 같습니다.

### 인프라 모드

<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/c78c99c4-58e0-48af-a4ee-ed76d813c72b" width="500">

- 기지국은 모바일을 유선 네트워크로 연결합니다.
- 핸드오프 : 모바일로 기지국을 변경하여 유선 네트워크로 연결

### Ad hoc 모드

<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/04d2f4d7-d29a-479d-95ba-bbc799c056e7" width="500">        

- 기지국이 없다
- 노드는 링크 내의 다른 노드에만 전송할 수 있다
- 노드들은 자기 자신을 '서로를 이어주는 네트워크'로 조직합니다.
- 
##### **유 / 무선랜이 갖는 다른네트워크 와의 연결 방식
<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/8f492dd7-368a-46e6-94fb-c4ab53724536" width="500">

## 무선랜 네트워크의 요소들
1. 무선 호스트
<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/8de631c0-f6f9-49bd-a12d-ab735bbb7871" width="500">

- 랩탑, 스마트폰, 사물인터넷 등
- 어플리케이션들을 실행 시키는 것
- 고정식이거나 비 고정식 유선 네트워크 인프라 일 수 있다. (무선이 항상 비고정식인것은 아니다!)
2. 기지국
<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/c5d09b23-d500-472f-895c-003052d4c1a9" width="500">

- 일반적으로 유선 네트워크에 연결되어 있다.
- 릴레이 - '영역'의 유선 네트워크와 무선 호스트(들) 간의 패킷 전송을 담당합니다.
- ex) 셀 타워, 802.11 엑세스 포인트
3. 무선 링크
<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/89fec29c-69ae-411e-8f75-9d4bb9f752a8" width="500">

- 일반적으로 모바일을 기지국에 연결하는데 사용되며, 백본 링크로도 사용된다.
- 다중 엑세스 프로토콜은 링크 엑세스를 조정한다.
- 다양한 전송 속도와 거리, 주파수 대역
___
**무선 랜에는 유선 랜에 적용되지 않거나 존재가 무시될 수 있는 몇 가지 특성이 있다. 무선랜 프로토콜에 대해 알아가기 위해 이 특성중 일부에 대해 알아보자.**
## 무선 랜의 특징 
#### 유선 랜과의 차이점
- 신호 세기 감소
무선 신호가 물질을 통과하며 전파할때 감소 합니다.
- 다른 소스로부터의 간섭
많은 디바이스에 공유되는 무선 네트워크의 주파수 ex) 2.4Ghz, WiFi
- 다중 경로 전파
무선 신호는 물체를 반사하여 약간 다른 시간에 목적지에 도착 한다.

즉, 무선 링크는 통신을 훨씬 더 어렵게 한다. (심지어 한 지점간에 통신도 더 어려워 진다.)
#### 그냥 특징
<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/eafb4c48-e2f7-44ed-b7e1-34f67bbe217b" width="500">

- SNR (signal to noise ratio)*신호 대비 잡음의 비율*
더 큰 SNR일 수록 노이즈에서 신호를 추출하기가 쉽다 즉, 노이즈의 간섭이 덜하다(좋은것)
- BER (Bit Error Ratio) *비트대비 에러 비율*
SNR과 반대되는 개념으로 둘은 반비례 관계이다.

1. 특정한 변조 방식이 주어진 경우
전력을 증가 시키면 SNR 증가, BER 감소
즉, 더 높은 전력을 투입할 수록 더 나은 SNR을 얻을 수 있고, BER을 줄여 통신의 신뢰성을 높일 수 있다.
2. SNR이 주어진 경우
BER 요구 사항을 충족하는 변조 기술을 선택하여 최대 처리량을 제공한다.
    SNR은 이동성에 따라 변화할수 있다. : 동적으로 변조방식이나 속도 등을 적응시킴

$10^{-4}$ 미만의  BER을 보장하려면 BPSK의 경우 8 db 또는 QAM16의 경우 17db의 SNR을 충족해야 합니다.

#### 다중 무선 송신기, 수신기가 추가적인 문제를 일으킵니다.

<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/1ebe32f1-33ed-435d-8ee8-04d6abc33d2e" width="500">

A 와 B는 서로의 신호를 들을 수 있고, C 와 B도 서로의 신호를 들을 수 있다.
A 와 C는 서로의 신호를 들을 수 없기에 자신들이 서로가 B 와 주고받는 신호를 간섭할 수 있다는 것을 모른다.

<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/c60bc4ea-7c85-44ca-8de8-0a9ea21848ed" width="500">

___


**아마도 무선랜에서 우리가 논의해야 할 가장 중요한 문제는 무선 호스트가 공유 매체(공기)에 접근하는 방법인 액세스 제어일 것입니다. CSMA/CD 알고리즘은 다음 세 가지 이유로 무선랜에서 작동하지 않습니다:**

1. 무선 호스트는 동시에 송수신할 수 있는 전력이 부족합니다.

2. 숨겨진 스테이션(단말기) 문제로 인해 충돌 감지가 불가능합니다

3. 역 사이의 거리가 클 수 있습니다.

IEEE는 물리적 계층과 데이터 링크 계층을 포함하는 IEEE 802.11이라고 불리는 무선랜의 사양을 정의했습니다. 그것은 때때로 무선 이더넷이라고 불립니다. 미국을 포함한 일부 국가에서, 대중은 무선랜의 동의어로서 WiFi (무선 충실도의 줄임말)라는 용어를 사용합니다. 그러나 WiFi는 WiFi Alliance에 의해 인증된 무선랜입니다

이 표준은 기본 서비스 세트(BSS : Basic service set)와 확장 서비스 세트(ESS : Extended service set)의 두 가지 종류의 서비스를 정의합니다.

BSS – 고정/무선 스테이션 + AP
- AP 가 있으면 인프라 BSS 없으면 스테이션 각각이 AP로서 작동하는 Ad hoc BSS
ESS - **AP가 있는** 2개 이상의 BSS

<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/fde07143-e0ac-4255-9968-ab812174d2ec" width="500">

## 802.11
### LAN 구조
<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/b3d9fd26-89b4-4087-b05b-1ffea7b9ec9c" width="500">

- 무선 호스트는 기지국과 통신
    기지국 = AP
- 인프라 모드의 BSS는 아래 두가지를 포함한다.
   - 무선 호스트
   - 기지국
  *ad hoc 모드는 호스트만 포함한다.*
### 채널들, 연결
- 서로 다른 주파수의 채널로 분할된 스펙트럼
  - AP관리자가  AP의 주파수를 선택합니다.
  - 간섭 가능 *채널은 인점 AP가 선택한 채널과 동일할 수 있다.*
- 도착 호스트는 AP와 연결해야만 합니다.
  - 채널을 검색하고, AP 이름 및 MAC 주소가 포함된 비콘 프레임 듣기
  - 연결할 AP 선택
  - 그러면 인증을 할 수 있습니다.
  - 그 다음 일반적으로 DHCP를 실행하여  AP의 서브넷에서 IP 주소를 가져옵니다.
 
### 패시브/액티브 스캐닝
<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/69bad79b-1417-4b24-8d13-88874fa51047" width="500">

- **패시브 스캐닝**
  - AP에서 비콘프레임을 보냄
  - 연결 요구 프레임을 H1 에서 선택한 AP로 보냄
  - 연결 응답 프레임을 선택된 AP 에서 H1으로 보냄
- **액티브 스캐닝**
  - 조사 요구 프레임을 H1에서 부터 방송 ( 범위내 전부 )
  - 조사 응답 프레임을 AP에서 H1으로 보냄
  - 연결 요구 프레임을 H1에서 선택한 AP로 보냄
  - 연결 응답 프레임을 선택된 AP에서 H1으로 보냄
___
IEEE 802.11은 데이터 링크 계층을 위한 두 개의 부계층, 즉 LLC와 MAC을 정의합니다.

<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/e8dc5027-94ba-4e9c-a7c9-9760c7afd228" width="500">

또한 두 개의 MAC 부계층, 즉 DCF(Distributed Coordination Function)와 PCF(Point Coordination Function)를 정의합니다. 그림 1.6은 두 MAC 부계층, LLC 부계층 및 물리계층 간의 관계를 보여줍니다. 물리계층 구현에 대해서는 이 장의 뒷부분에서 논의하며 이제 MAC 부계층에 초점을 맞출 것입니다.
___
## IEEE 802.11
### 다중 접속
**2개 이상의 노드가 동시에 전송되기 때문에 충돌을 방지해야 한다**
- CSMA - 전송전에 감지하기
  - 다른 노드에서 탐지된 진행 중인 전송과 충돌하지 않음
- 충돌을 감지하는건 어려움
  - 높은 송신신호, 페이딩으로 인한 약한 수신신호 로 인해 어려움
  - 어떤 경우에도 모든 충돌을 감지할 수는 없다. (숨겨진 터미널 , 페이딩 등)

**목표는 충돌 회피!**
- CSMA / CA

## CSMA / CA
#### sender
1. 만약 감지하는 채널이 DIFS 동안 쉬고있다면
  전체 프레임 전송
2. 감지하는 채널이 바쁘다면
   1. 무작위 백오프시간 시작
   2. 쉬면서 타이머 카운트 다운
   3. 타이머가 만료되면 전송
   4. 응답이 없으면 백오프타임 늘리고 반복
#### receiver
1. 프레임이 정상이면 OK
  - SIFS 후 응답 리턴

#### DIFS / SIFS
- DIFS
  - DCF 방식에서 적어도 DIFS 동안 매체가 쉬는 상태인 이후에 접근을 시도하게 되는 기준 시간
  - 무선 단말이 무선 매체를 마지막으로 사용한 직후부터 기다려야 할 최소 시간
- SIFS
  - 가장 짧은 대기지연시간 (가장 높은 우선순위)
  - DIFS, EIFS 등의 시간 계산에도 쓰여

### 문제 발생
#### 히든 스테이션
- 아이디어
  - 작은 예약 패킷을 사용하는 데이터 프레임을 사용하는 'reserves' 채널을 사용하자
  - **예약패킷**
    - RTS/CTS 프레임
    - RTS : 준비됐어 브로?
    - CTS : 준비됐어 브로.

1. sender는 먼저 RTS를 목적지에 전송 (여전히 RTS는 서로 충돌 할 수 있지만 매우 짧다)
2. 목적지가 CTS를 방송
3. 모든 노드가 CTS를 듣고 sender는 데이터 프레임 전송 / 다른 노드들은 전송을 연기
4. 연기하기 위해 NAV 사용
   - 타이머

<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/cdb1ce25-26f5-4937-88cc-89a3261eca18" width="500">


### MAC haeder
<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/052a9ef8-08fe-49be-9819-db4cb865903d" width="500">

- Frame Control
프레임 관련 제어정보
- 기간 / ID
NAV 설정, 전력절감조사 등
- 주소 1,2,3,4
대부분 3개 주소 1,2,3 만 사용
무선 브리지를 경유하여 전송되는 경우 4개 주소 사용
제어프레임 중 ACK 프레임인 경우 1개의주소만 사용
- 순서 컨트롤
프레임별 순서 부여
- FCS
에러 검출용

### Frame Control 형태
<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/a9627984-a4fd-4c6b-ae1a-610290bff111" width="500">

1. Protocol Ver - 2bit
버전을 나타낸다 (현재는 버전이 1개라 00 고정)
2. Type - 2bit
프레임의 유형을 나타낸다   (00:관리프레임, 01:제어프레임, 10:데이터프레임)
3. Subtype - 2bit
각 Type 유형에서 나눠지는 세부 유형
4. To DS From DS - 각 1bit
어디서 와서 어디로 가는지 (MAC 헤더의 Address 필드 값 식별에 사용)
5. More Frag - 1bit
분열된 경우 1, 분열되지 않았거나 마지막 frag인 경우 0
6. Retry - 1bit
이전 프레임의 재전송인 경우 1
7. Power Mgmt - 1bit
전력절감 모드일 경우 1, 활성화 모드일경우 0 (AP는 항상 활성화모드 = 0)
8. More data - 1bit
AP가 더많은 데이터를 보내려고 대기중일 경우 1, 아닐경우 0
9. WEP - 1bit
프레임 몸체가 암호화 되어있다면 1, 아니면 0
10. RSVD - 1bit
예약 되었는지 확인  (1 일 경우 HT Control Field 포함)

### To DS From DS
<img src="https://github.com/Ahn-TaeKyung/Study/assets/154008745/a98c5648-a70c-4314-bb42-5d3e170c9135" width="500">

